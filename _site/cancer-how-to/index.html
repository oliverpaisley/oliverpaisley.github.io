<!DOCTYPE html>
<html>

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Using R, rCharts, and NVD3 to Visualize Cancer Rates in the US &#8211; Observable Data</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="A breakdown of where to find the data, how to transform it into an applicable format, and how to create and customize interactive visualizations that can be easily shared.">
  <meta name="author" content="Oliver Paisley">
  <meta name="keywords" content="">
  <link rel="canonical" href="http://observabledata.com/cancer-how-to/">
  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Observable Data" href="/feed.xml" />

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/pixyll.css?201508172013" type="text/css">

  <!-- Fonts -->
  <link href='http://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
  
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
  

  <!-- Open Graph -->
  <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
  <meta property="og:title" content="Using R, rCharts, and NVD3 to Visualize Cancer Rates in the US">
  <meta property="og:description" content="A breakdown of where to find the data, how to transform it into an applicable format, and how to create and customize interactive visualizations that can be easily shared.">
  <meta property="og:url" content="http://observabledata.com/cancer-how-to/">
  <meta property="og:site_name" content="Observable Data">
  <meta property="fb:app_id" content="904518042946899">
  
    <meta property="og:image" content="http://observabledata.com/images/cancer.png">
  

  <!-- Twitter Card -->
  
    <meta name="twitter:image:src" content="http://observabledata.com/images/cancer.png">
  
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:creator" content="@oliverjdpaisley" />
  <meta name="twitter:title" content="Using R, rCharts, and NVD3 to Visualize Cancer Rates in the US" />
  <meta name="twitter:description" content="A breakdown of where to find the data, how to transform it into an applicable format, and how to create and customize interactive visualizations that can be easily shared." />
  <meta name="twitter:url" content="http://observabledata.com/cancer-how-to/" />
  <meta name="twitter:site" content="@oliverjdpaisley" />

  <!-- Icons -->
  <link rel="icon" type="image/png" href="/favicon-16x16.png">

  <style type="text/css">
  
  @charset "UTF-8";
/*!

  BASSCSS

  Next-level CSS toolkit - basscss.com

  Made with love by Jxnblk - ┬⌐2014 Brent Jackson
  MIT License http://opensource.org/licenses/MIT

*/
/* Basscss Base Buttons */
button,
.button {
  font-family: "Roboto Slab", serif;
  font-size: inherit;
  font-weight: normal;
  text-decoration: none;
  cursor: pointer;
  display: inline-block;
  box-sizing: border-box;
  line-height: 1.125rem;
  padding: 0.5rem 1rem;
  margin: 0;
  height: auto;
  border: 1px solid transparent;
  vertical-align: middle;
  -webkit-appearance: none; }

::-moz-focus-inner {
  border: 0;
  padding: 0; }

.button:hover {
  text-decoration: none; }

/* Basscss Base Forms */
input,
select,
textarea,
fieldset {
  font-size: 1rem;
  margin-top: 0;
  margin-bottom: 0.5rem; }

input[type=text],
input[type=datetime],
input[type=datetime-local],
input[type=email],
input[type=month],
input[type=number],
input[type=password],
input[type=search],
input[type=tel],
input[type=time],
input[type=url],
input[type=week] {
  box-sizing: border-box;
  height: 2.25rem;
  padding: 0.5rem 0.5rem;
  vertical-align: middle;
  -webkit-appearance: none; }

select {
  box-sizing: border-box;
  line-height: 1.75;
  padding: 0.5rem 0.5rem; }

select:not([multiple]) {
  height: 2.25rem;
  vertical-align: middle; }

textarea {
  box-sizing: border-box;
  line-height: 1.75;
  padding: 0.5rem 0.5rem; }

.fieldset-reset {
  padding: 0;
  margin-left: 0;
  margin-right: 0;
  border: 0; }

.fieldset-reset legend {
  padding: 0; }

body,
button {
  margin: 0; }

button,
input,
select,
textarea {
  font-family: inherit;
  font-size: 100%; }

img {
  max-width: 100%; }

svg {
  max-height: 100%; }

/* Basscss Base Typography */
header {
  line-height: 1; }

body {
  font-family: "Roboto Slab", serif;
  line-height: 1.5;
  font-size: 100%; }

h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: "Roboto Slab", serif;
  font-weight: 700;
  line-height: 1;
  margin-top: 1em;
  margin-bottom: .5em; }

p,
dl,
ol,
ul {
  font-size: 1rem;
  margin-top: 0;
  margin-bottom: 1rem; }

ol,
ul {
  padding-left: 2rem; }

pre,
code,
samp {
  font-family: "Source Code Pro", Consolas, monospace;
  font-size: inherit; }

pre {
  margin-top: 0;
  margin-bottom: 1rem;
  overflow-x: scroll; }

hr {
  margin-top: 2rem;
  margin-bottom: 2rem; }

blockquote {
  margin-top: 2rem;
  margin-bottom: 2rem;
  margin-left: 0;
  padding-left: 1rem;
  padding-right: 1rem; }

blockquote,
blockquote p {
  font-size: 1.25rem;
  font-style: italic; }

h1,
.h1 {
  font-size: 2rem; }

h2,
.h2 {
  font-size: 1.8rem; }

h3,
.h3 {
  font-size: 1.25rem; }

h4,
.h4 {
  font-size: 1rem; }

h5,
.h5 {
  font-size: 0.875rem; }

h6,
.h6 {
  font-size: 0.75rem; }

.list-reset {
  list-style: none;
  padding-left: 0; }

.button-blue {
  color: white;
  background-color: #0076df;
  border-radius: 3px;
  transition-duration: .1s;
  transition-timing-function: ease-out;
  transition-property: box-shadow, background-color; }

.button-blue:hover {
  opacity: .875; }

.button-blue:active,
.button-blue.is-active {
  box-shadow: inset 0 0 0 32px rgba(0, 0, 0, 0.125), inset 0 2px 3px 0 rgba(0, 0, 0, 0.25); }

.button-blue:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.5), 0 0 1px 4px rgba(0, 118, 223, 0.5); }

.button-blue:disabled,
.button-blue.is-disabled {
  opacity: .5; }

.highlight {
  -webkit-text-size-adjust: none; }

.highlight .c1 {
  color: #777;
  font-style: italic; }

.highlight .k,
.highlight .kp {
  color: #333; }

.highlight .mi {
  color: #00ab37; }

.highlight .s1 {
  color: #f95020; }

.hljs-title,
.hljs-id,
.scss .hljs-preprocessor {
  color: #f95020;
  font-weight: bold; }

.highlight .k {
  font-weight: normal; }

.highlight .nc,
.highlight .no {
  color: #00369f; }

.highlight .o {
  color: #00369f;
  font-weight: normal; }

.highlight .nb {
  color: #00ab37; }

.highlight .sr {
  color: #00ab37; }

.highlight .ss {
  color: #f92080; }

.hljs-built_in {
  color: #00369f; }

.hljs-preprocessor,
.hljs-pragma,
.hljs-pi,
.hljs-doctype,
.hljs-shebang,
.hljs-cdata {
  color: #777;
  font-weight: bold; }

.hljs-deletion {
  background: #ffdddd; }

.hljs-addition {
  background: #ddffdd; }

.diff .hljs-change {
  background: #00369f; }

.hljs-chunk {
  color: #ccc; }

.highlight .hll {
  background-color: #ffffcc; }

.highlight {
  background: #f8f8f8; }

.highlight .c {
  color: #8f5902;
  font-style: italic; }

/* Comment */
.highlight .err {
  color: #a40000;
  border: 1px solid #ef2929; }

/* Error */
.highlight .g {
  color: #000000; }

/* Generic */
.highlight .k {
  color: #204a87;
  font-weight: bold; }

/* Keyword */
.highlight .l {
  color: #000000; }

/* Literal */
.highlight .n {
  color: #000000; }

/* Name */
.highlight .o {
  color: #ce5c00;
  font-weight: bold; }

/* Operator */
.highlight .x {
  color: #000000; }

/* Other */
.highlight .p {
  color: #000000;
  font-weight: bold; }

/* Punctuation */
.highlight .cm {
  color: #8f5902;
  font-style: italic; }

/* Comment.Multiline */
.highlight .cp {
  color: #8f5902;
  font-style: italic; }

/* Comment.Preproc */
.highlight .c1 {
  color: #8f5902;
  font-style: italic; }

/* Comment.Single */
.highlight .cs {
  color: #8f5902;
  font-style: italic; }

/* Comment.Special */
.highlight .gd {
  color: #a40000; }

/* Generic.Deleted */
.highlight .ge {
  color: #000000;
  font-style: italic; }

/* Generic.Emph */
.highlight .gr {
  color: #ef2929; }

/* Generic.Error */
.highlight .gh {
  color: #000080;
  font-weight: bold; }

/* Generic.Heading */
.highlight .gi {
  color: #00A000; }

/* Generic.Inserted */
.highlight .go {
  color: #000000;
  font-style: italic; }

/* Generic.Output */
.highlight .gp {
  color: #8f5902; }

/* Generic.Prompt */
.highlight .gs {
  color: #000000;
  font-weight: bold; }

/* Generic.Strong */
.highlight .gu {
  color: #800080;
  font-weight: bold; }

/* Generic.Subheading */
.highlight .gt {
  color: #a40000;
  font-weight: bold; }

/* Generic.Traceback */
.highlight .kc {
  color: #204a87;
  font-weight: bold; }

/* Keyword.Constant */
.highlight .kd {
  color: #204a87;
  font-weight: bold; }

/* Keyword.Declaration */
.highlight .kn {
  color: #204a87;
  font-weight: bold; }

/* Keyword.Namespace */
.highlight .kp {
  color: #204a87;
  font-weight: bold; }

/* Keyword.Pseudo */
.highlight .kr {
  color: #204a87;
  font-weight: bold; }

/* Keyword.Reserved */
.highlight .kt {
  color: #204a87;
  font-weight: bold; }

/* Keyword.Type */
.highlight .ld {
  color: #000000; }

/* Literal.Date */
.highlight .m {
  color: #0000cf;
  font-weight: bold; }

/* Literal.Number */
.highlight .s {
  color: #4e9a06; }

/* Literal.String */
.highlight .na {
  color: #c4a000; }

/* Name.Attribute */
.highlight .nb {
  color: #204a87; }

/* Name.Builtin */
.highlight .nc {
  color: #000000; }

/* Name.Class */
.highlight .no {
  color: #000000; }

/* Name.Constant */
.highlight .nd {
  color: #5c35cc;
  font-weight: bold; }

/* Name.Decorator */
.highlight .ni {
  color: #ce5c00; }

/* Name.Entity */
.highlight .ne {
  color: #cc0000;
  font-weight: bold; }

/* Name.Exception */
.highlight .nf {
  color: #000000; }

/* Name.Function */
.highlight .nl {
  color: #f57900; }

/* Name.Label */
.highlight .nn {
  color: #000000; }

/* Name.Namespace */
.highlight .nx {
  color: #000000; }

/* Name.Other */
.highlight .py {
  color: #000000; }

/* Name.Property */
.highlight .nt {
  color: #204a87;
  font-weight: bold; }

/* Name.Tag */
.highlight .nv {
  color: #000000; }

/* Name.Variable */
.highlight .ow {
  color: #204a87;
  font-weight: bold; }

/* Operator.Word */
.highlight .w {
  color: #f8f8f8;
  text-decoration: underline; }

/* Text.Whitespace */
.highlight .mf {
  color: #0000cf;
  font-weight: bold; }

/* Literal.Number.Float */
.highlight .mh {
  color: #0000cf;
  font-weight: bold; }

/* Literal.Number.Hex */
.highlight .mi {
  color: #0000cf;
  font-weight: bold; }

/* Literal.Number.Integer */
.highlight .mo {
  color: #0000cf;
  font-weight: bold; }

/* Literal.Number.Oct */
.highlight .sb {
  color: #4e9a06; }

/* Literal.String.Backtick */
.highlight .sc {
  color: #4e9a06; }

/* Literal.String.Char */
.highlight .sd {
  color: #8f5902;
  font-style: italic; }

/* Literal.String.Doc */
.highlight .s2 {
  color: #4e9a06; }

/* Literal.String.Double */
.highlight .se {
  color: #4e9a06; }

/* Literal.String.Escape */
.highlight .sh {
  color: #4e9a06; }

/* Literal.String.Heredoc */
.highlight .si {
  color: #4e9a06; }

/* Literal.String.Interpol */
.highlight .sx {
  color: #4e9a06; }

/* Literal.String.Other */
.highlight .sr {
  color: #4e9a06; }

/* Literal.String.Regex */
.highlight .s1 {
  color: #4e9a06; }

/* Literal.String.Single */
.highlight .ss {
  color: #4e9a06; }

/* Literal.String.Symbol */
.highlight .bp {
  color: #3465a4; }

/* Name.Builtin.Pseudo */
.highlight .vc {
  color: #000000; }

/* Name.Variable.Class */
.highlight .vg {
  color: #000000; }

/* Name.Variable.Global */
.highlight .vi {
  color: #000000; }

/* Name.Variable.Instance */
.highlight .il {
  color: #0000cf;
  font-weight: bold; }

/* Literal.Number.Integer.Long */
/* Basscss Color Base */
body {
  color: #333;
  background-color: white; }

a {
  color: #333;
  text-decoration: none;
  border-bottom: 1px solid #333; }

a:hover {
  border-bottom: 1px solid #fff; }

pre,
code {
  background-color: #eee;
  border-radius: 3px; }

hr {
  border: 0;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #ccc; }

/* Basscss Colors */
.dark-gray {
  color: #333; }

.white {
  color: white; }

.blue {
  color: #0076df; }

.mid-gray {
  color: #777; }

.light-gray {
  color: #ccc; }

.lighter-gray {
  color: #eee; }

.red {
  color: #f95020; }

.green {
  color: #00cf26; }

.yellow {
  color: #efcc00; }

.orange {
  color: #ffcc22; }

.bg-dark-gray {
  background-color: #333; }

.bg-white {
  background-color: white; }

.bg-blue {
  background-color: #0076df; }

.bg-mid-gray {
  background-color: #777; }

.bg-light-gray {
  background-color: #ccc; }

.bg-lighter-gray {
  background-color: #eee; }

.bg-red {
  background-color: #f95020; }

.bg-green {
  background-color: #00cf26; }

.bg-yellow {
  background-color: #efcc00; }

.bg-orange {
  background-color: #ffcc22; }

.bg-darken-1 {
  background-color: rgba(0, 0, 0, 0.0625); }

.bg-darken-2 {
  background-color: rgba(0, 0, 0, 0.125); }

.bg-darken-3 {
  background-color: rgba(0, 0, 0, 0.25); }

.bg-darken-4 {
  background-color: rgba(0, 0, 0, 0.5); }

/* Basscss Utility Headings */
.h00 {
  font-size: 4rem; }

.h0 {
  font-size: 3rem; }

@media (min-width: 52em) {
  .h00-responsive {
    font-size: 8vw; }

  .h0-responsive {
    font-size: 6vw; }

  .h1-responsive {
    font-size: 4vw; } }
@media (min-width: 96em) {
  .h00-responsive {
    font-size: 7.68rem; }

  .h0-responsive {
    font-size: 5.76rem; }

  .h1-responsive {
    font-size: 3.84rem; } }
/* Basscss Utility Typography */
.bold {
  font-weight: bold; }

.regular {
  font-weight: normal; }

.italic, .post-footer {
  font-style: italic; }

.caps {
  text-transform: uppercase;
  letter-spacing: .2em; }

.left-align {
  text-align: left; }

.center {
  text-align: center; }

.right-align {
  text-align: right; }

.justify {
  text-align: justify; }

.nowrap {
  white-space: nowrap; }

/* Basscss Utility White Space */
.m0 {
  margin: 0; }

.mt0 {
  margin-top: 0; }

.mr0 {
  margin-right: 0; }

.mb0 {
  margin-bottom: 0; }

.ml0 {
  margin-left: 0; }

.m1 {
  margin: 0.5rem; }

.mt1 {
  margin-top: 0.5rem; }

.mr1 {
  margin-right: 0.5rem; }

.mb1 {
  margin-bottom: 0.5rem; }

.ml1 {
  margin-left: 0.5rem; }

.m2 {
  margin: 1rem; }

.mt2 {
  margin-top: 1rem; }

.mr2 {
  margin-right: 1rem; }

.mb2 {
  margin-bottom: 1rem; }

.ml2 {
  margin-left: 1rem; }

.m3 {
  margin: 2rem; }

.mt3 {
  margin-top: 2rem; }

.mr3 {
  margin-right: 2rem; }

.mb3 {
  margin-bottom: 2rem; }

.ml3 {
  margin-left: 2rem; }

.m4 {
  margin: 4rem; }

.mt4 {
  margin-top: 4rem; }

.mr4 {
  margin-right: 4rem; }

.mb4 {
  margin-bottom: 4rem; }

.ml4 {
  margin-left: 4rem; }

.mxn1 {
  margin-left: -0.5rem;
  margin-right: -0.5rem; }

.mxn2 {
  margin-left: -1rem;
  margin-right: -1rem; }

.mxn3 {
  margin-left: -2rem;
  margin-right: -2rem; }

.mxn4 {
  margin-left: -4rem;
  margin-right: -4rem; }

.mx-auto {
  margin-left: auto;
  margin-right: auto; }

.p1 {
  padding: 0.5rem; }

.py1 {
  padding-top: 0.5rem;
  padding-bottom: 0.5rem; }

.px1 {
  padding-left: 0.5rem;
  padding-right: 0.5rem; }

.p2 {
  padding: 1rem;
  padding-top: 0rem; }

.py2 {
  padding-top: 1rem;
  padding-bottom: 1rem; }

.px2 {
  padding-left: 1rem;
  padding-right: 1rem; }

.p3 {
  padding: 2rem; }

.py3 {
  margin-top: 28.8px;
  padding-bottom: 2rem; }

.px3 {
  padding-left: 2rem;
  padding-right: 2rem; }

.p4 {
  padding: 4rem; }

.py4 {
  padding-top: 4rem;
  padding-bottom: 4rem; }

.px4 {
  padding-left: 4rem;
  padding-right: 4rem; }

/*!

Pixyll

A simple, beautiful theme for Jekyll that emphasizes content rather than
aesthetic fluff.

Built upon BASSCSS (http://jxnblk.github.io/basscss).

Crafted with <3 by John Otander (@4lpine) - ©2015 John Otander
MIT License http://opensource.org/licenses/MIT

*/
html {
  overflow-y: scroll; }

html,
body {
  height: auto;
  min-height: 100%; }

img {
  width: auto;
  max-width: 100%; }

body {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box; }

.left {
  float: left; }

.right {
  float: right; }

.clearfix:before,
.clearfix:after {
  content: ' ';
  display: table; }

.clearfix:after {
  clear: both; }

pre,
pre code {
  background-color: transparent;
  border-radius: 0; }

pre,
code {
  font-family: "Source Code Pro", Consolas, monospace; }

pre {
  padding-right: 1.125em;
  padding-left: 1.125em;
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  line-height: 1.2;
  margin-bottom: 0.88em;
  overflow-x: auto;
  background-color: #f1f1f1; }

.highlight .p {
  font-size: 1.125rem;
  line-height: 1; }

.highlight a {
  border: 0px; }

code {
  counter-reset: linenumber; }

.lineno {
  visibility: hidden;
  font-size: 0; }
  .lineno::before {
    opacity: 0.7;
    padding-right: 10px;
    margin-right: 5px;
    padding-top: 4px;
    padding-bottom: 4px;
    border-right: 1px solid #333;
    font-size: 0.8rem;
    content: "" counter(linenumber);
    counter-increment: linenumber;
    visibility: visible;
    display: inline-block;
    width: 1rem;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none; }

input,
select,
textarea,
fieldset {
  font-size: 1rem;
  margin-top: 0;
  margin-bottom: 0.5rem, 0.5rem; }

input[type=text],
input[type=datetime],
input[type=datetime-local],
input[type=email],
input[type=month],
input[type=number],
input[type=password],
input[type=search],
input[type=tel],
input[type=time],
input[type=url],
input[type=week] {
  box-sizing: border-box;
  height: 2.25rem;
  padding: 0.5rem 0.5rem;
  vertical-align: middle;
  -webkit-appearance: none; }

select {
  box-sizing: border-box;
  line-height: 1.75;
  padding: 0.5rem 0.5rem; }

select:not([multiple]) {
  height: 2.25rem;
  vertical-align: middle; }

textarea {
  box-sizing: border-box;
  line-height: 1.75;
  padding: 0.5rem 0.5rem; }

.form-stacked input,
.form-stacked textarea,
.form-stacked select {
  width: 100%; }

.field-light {
  background-color: white;
  transition: box-shadow .2s ease;
  border-style: solid;
  border-width: 1px;
  border-color: #ccc;
  border-radius: 3px; }

.field-light:focus {
  outline: none;
  border-color: #0076df;
  box-shadow: 0 0 2px rgba(0, 118, 223, 0.5); }

.field-light:disabled {
  color: #777;
  background-color: rgba(0, 0, 0, 0.125); }

.field-light:read-only:not(select) {
  background-color: rgba(0, 0, 0, 0.125); }

.field-light:invalid {
  border-color: #f95020; }

.field-light.is-success {
  border-color: #00cf26; }

.field-light.is-warning {
  border-color: #efcc00; }

.field-light.is-error {
  border-color: #f95020; }

.radio-light,
.checkbox-light {
  transition: box-shadow .2s ease; }

.radio-light {
  border-radius: 50%; }

.radio-light:focus,
.checkbox-light:focus {
  outline: none;
  box-shadow: 0 0 2px rgba(0, 118, 223, 0.5); }

html {
  font-size: 14px; }

abbr {
  border-bottom: 1px black dotted;
  cursor: help; }

p {
  color: #333;
  line-height: 1.5; }

small,
.small {
  font-size: 0.707rem; }

.site-header {
  text-align: center;
  color: #333; }

.site-header .site-title {
  font-size: 2rem; }

.site-nav .visuals {
  font-size: 1.5rem;
  padding-top: 12px; }

.site-nav .about {
  font-size: 1rem;
  padding-top: 12px; }

/*
  Table styles copied from Bootstrap
  Copyright (c) 2013 Twitter, Inc
*/
table {
  width: 100%;
  max-width: 100%;
  margin-bottom: 1.5;
  font-size: 1.125rem; }
  table > thead > tr > th,
  table > thead > tr > td,
  table > tbody > tr > th,
  table > tbody > tr > td,
  table > tfoot > tr > th,
  table > tfoot > tr > td {
    padding: 12px;
    line-height: 1.2;
    vertical-align: top; }
  table > thead > tr > th {
    vertical-align: bottom;
    border-bottom: 2px solid #333; }
  table > caption + thead > tr:first-child > th,
  table > caption + thead > tr:first-child > td,
  table > colgroup + thead > tr:first-child > th,
  table > colgroup + thead > tr:first-child > td,
  table > thead:first-child > tr:first-child > th,
  table > thead:first-child > tr:first-child > td {
    border-top: 0; }
  table > tbody + tbody {
    border-top: 2px solid #333; }

/*
  Table styles copied from Bootstrap
  Copyright (c) 2013 Twitter, Inc
*/
table {
  width: 100%;
  max-width: 100%;
  margin-bottom: 1.5;
  font-size: 1.125rem; }
  table > thead > tr > th,
  table > thead > tr > td,
  table > tbody > tr > th,
  table > tbody > tr > td,
  table > tfoot > tr > th,
  table > tfoot > tr > td {
    padding: 12px;
    line-height: 1.2;
    vertical-align: top; }
  table > thead > tr > th {
    vertical-align: bottom;
    border-bottom: 2px solid #333; }
  table > caption + thead > tr:first-child > th,
  table > caption + thead > tr:first-child > td,
  table > colgroup + thead > tr:first-child > th,
  table > colgroup + thead > tr:first-child > td,
  table > thead:first-child > tr:first-child > th,
  table > thead:first-child > tr:first-child > td {
    border-top: 0; }
  table > tbody + tbody {
    border-top: 2px solid #333; }

.site {
  display: flex;
  flex-direction: column;
  min-height: 100vh; }

.site-wrap {
  flex: 1; }

footer {
  background-color: #fafafa;
  border-top: thin solid #f3f3f3;
  color: #7a7a7a;
  font-size: 0.75rem;
  font-weight: 300;
  padding: 2rem;
  text-align: center; }

.social-icons {
  color: #000000;
  width: 5%; }

.share-links {
  padding-top: 1em;
  margin-top: 1em;
  padding-bottom: 1em; }

.share-links a.fa {
  border: none;
  padding-left: 0.3em;
  padding-right: 0.3em; }

.fb-like {
  margin-left: 0.3em;
  margin-bottom: 0.3em; }

blockquote {
  border-left: 5px solid #7a7a7a;
  font-style: italic;
  margin-left: 0.5rem;
  padding: 0.5rem; }

blockquote footer {
  background-color: #fff;
  border-color: transparent;
  color: #7a7a7a;
  font-size: .85rem;
  font-style: normal;
  text-align: left;
  padding: 0; }

.posts {
  margin: 0; }

.post-link .post-title {
  font-weight: 600;
  color: #333;
  display: inline;
  margin-top: 20px; }

.post-footer {
  margin-top: .75rem;
  text-align: center; }

.post-footer .avatar {
  margin: 0;
  width: 100px;
  border-radius: 50%; }

.meta,
.post-meta {
  width: auto;
  font-weight: 300;
  margin: 0;
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  color: #7a7a7a;
  font-style: italic; }

.post .post-content {
  border-bottom: thin solid #ccc;
  padding-bottom: 1em; }

@media screen and (min-width: 32rem) {
  html {
    font-size: 16px; }

  h1,
  .h1 {
    font-size: 3rem; }

  .site-header .site-title {
    font-size: 3rem;
    float: left; }

  .site-header .site-nav {
    float: right;
    margin-top: 8px; }

  .site-header .site-nav .visuals {
    float: left;
    font-size: 1.5rem;
    padding-right: 15px; }

  .site-header .site-nav .about {
    float: right;
    font-size: 1.5rem; }

  .p2 {
    padding: 1rem; }

  blockquote {
    margin-left: 2rem;
    padding: 2rem; } }
.gist,
.gist .highlight .p {
  font-size: .75rem; }

.gist .lines {
  width: 100%; }

.measure {
  margin: 0 auto;
  max-width: 60rem; }

.pagination {
  font-size: 1rem;
  font-family: 'Lato', 'Helvetica Neue', Helvetica, sans-serif;
  font-weight: 300;
  text-align: center; }

.pagination a, .pagination .disabled {
  color: #000000;
  border-bottom: 2px solid #000000; }

.pagination a:hover,
.pagination a:focus,
.pagination a:active {
  border-bottom: none; }

</style>


  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-65908947-1', 'auto');
  ga('send', 'pageview');
</script>


</head>


<body class="site">

  <script>
    window.fbAsyncInit = function() {
      FB.init({
        appId      : '904518042946899',
        xfbml      : true,
        version    : 'v2.4'
      });
    };

    (function(d, s, id){
       var js, fjs = d.getElementsByTagName(s)[0];
       if (d.getElementById(id)) {return;}
       js = d.createElement(s); js.id = id;
       js.src = "//connect.facebook.net/en_US/sdk.js";
       fjs.parentNode.insertBefore(js, fjs);
     }(document, 'script', 'facebook-jssdk'));
  </script>

  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="http://observabledata.com" class="site-title">Observable Data</a>

      <div class="site-nav">
        <div class="visuals"><a href="/visuals/">Visuals</a></div>
        <div class="about"><a href="/about/">About</a></div>
      </div>

      <div class="clearfix"></div>
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        <div class="post-header mb2">
  <h2>Using R, rCharts, and NVD3 to Visualize Cancer Rates in the US</h2>
</div>
<article class="post-content">
  <ul>
  <li>This post is an explanation on how I created the graphs <a href="/visuals/cancer/">here</a>.</li>
  <li>It is assumed that basic knowledge of <a href="https://www.r-project.org/">R</a> is known.</li>
</ul>

<p>Our goal is to create an interactive graph of cancer rates in the United States.</p>

<p>There are 12 years worth of data available from the Centers of Disease Control and Prevention, and it can be obtained <a href="http://www.cdc.gov/cancer/npcr/uscs/download_data.htm">here</a>. The data is broken up into multiple files, depending on the variables of interest. We will be using the file <code>BYSITE.txt</code> to compare sites (types of cancer), and the file <code>BYAGE.txt</code> to compare age groups.</p>

<p>After downloading the data, we need to load it into R. We also need to load the packages we will be using. We will be using <a href="https://github.com/hadley/dplyr">dplyr</a> to process the data, <a href="http://rcharts.io/">rCharts</a> to create the graphs, and <a href="https://cran.r-project.org/web/packages/RColorBrewer/index.html">RColorBrewer</a> for pretty colors.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="lineno"> 1</span> <span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="lineno"> 2</span> <span class="kn">library</span><span class="p">(</span>rCharts<span class="p">)</span>
<span class="lineno"> 3</span> <span class="kn">library</span><span class="p">(</span>RColorBrewer<span class="p">)</span>
<span class="lineno"> 4</span> 
<span class="lineno"> 5</span> site_data <span class="o">&lt;-</span> read.table<span class="p">(</span><span class="s">&quot;BYSITE.TXT&quot;</span><span class="p">,</span>
<span class="lineno"> 6</span>                         sep              <span class="o">=</span> <span class="s">&#39;|&#39;</span><span class="p">,</span>
<span class="lineno"> 7</span>                         header           <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
<span class="lineno"> 8</span>                         stringsAsFactors <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
<span class="lineno"> 9</span> 
<span class="lineno">10</span> age_data  <span class="o">&lt;-</span> read.table<span class="p">(</span><span class="s">&quot;BYAGE.TXT&quot;</span><span class="p">,</span>
<span class="lineno">11</span>                         sep              <span class="o">=</span> <span class="s">&#39;|&#39;</span><span class="p">,</span>
<span class="lineno">12</span>                         header           <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
<span class="lineno">13</span>                         stringsAsFactors <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
<span class="lineno">14</span> 
<span class="lineno">15</span> <span class="kp">names</span><span class="p">(</span>age_data<span class="p">)</span>  <span class="o">&lt;-</span> <span class="kp">tolower</span><span class="p">(</span><span class="kp">names</span><span class="p">(</span>age_data<span class="p">))</span>
<span class="lineno">16</span> <span class="kp">names</span><span class="p">(</span>site_data<span class="p">)</span> <span class="o">&lt;-</span> <span class="kp">tolower</span><span class="p">(</span><span class="kp">names</span><span class="p">(</span>site_data<span class="p">))</span></code></pre></div>

<p>We now need to transform the data into a format acceptable for rCharts. rCharts connects to JavaScript libraries that utilize <a href="http://d3js.org/">D3.js</a>. The JavaScript library we will be connecting to is <a href="http://nvd3.org/">NVD3</a>.</p>

<p>Our first task is to create a graph where the x-axis is time (1999 to 2011), the y-axis is rate of cancer, and different colored lines represent different types of cancer. Therefore, we want 3 columns: year, cancer rate, and type of cancer. The number of rows will be equal to the number of combinations between year and type of cancer.</p>

<p>Since there are so many types of cancer, we will subset our data to include only the types that are most prevalent (highest rate). It is easy to see that the top 5 cancer types were the same for both 1999 and 2011.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="lineno"> 1</span> <span class="c1"># Change year to 2011 to see how they compare.</span>
<span class="lineno"> 2</span> site_data <span class="o">%&gt;%</span>
<span class="lineno"> 3</span>   filter<span class="p">(</span>year       <span class="o">==</span> <span class="s">&quot;1999&quot;</span><span class="p">,</span>
<span class="lineno"> 4</span>          sex        <span class="o">==</span> <span class="s">&quot;Male and Female&quot;</span><span class="p">,</span>
<span class="lineno"> 5</span>          race       <span class="o">==</span> <span class="s">&quot;All Races&quot;</span><span class="p">,</span>
<span class="lineno"> 6</span>          event_type <span class="o">==</span> <span class="s">&quot;Incidence&quot;</span><span class="p">,</span>
<span class="lineno"> 7</span>          count      <span class="o">!=</span> <span class="s">&quot;~&quot;</span><span class="p">,</span>
<span class="lineno"> 8</span>          count      <span class="o">!=</span> <span class="s">&quot;-&quot;</span><span class="p">,</span>
<span class="lineno"> 9</span>          count      <span class="o">!=</span> <span class="s">&quot;.&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
<span class="lineno">10</span>   mutate<span class="p">(</span>rate <span class="o">=</span> <span class="p">(</span><span class="kp">as.integer</span><span class="p">(</span>count<span class="p">)</span> <span class="o">/</span> <span class="kp">as.integer</span><span class="p">(</span>population<span class="p">))</span> <span class="o">*</span> <span class="m">1e5</span><span class="p">)</span> <span class="o">%&gt;%</span>
<span class="lineno">11</span>   arrange<span class="p">(</span>rate<span class="p">)</span> <span class="o">%&gt;%</span>
<span class="lineno">12</span>   select<span class="p">(</span>year<span class="p">,</span>
<span class="lineno">13</span>          site<span class="p">)</span> <span class="o">%&gt;%</span>
<span class="lineno">14</span>   <span class="kp">tail</span><span class="p">(</span><span class="m">7</span><span class="p">)</span></code></pre></div>

<p>Now we will subset our data based on those 5 cancer types, and also prepare our data for rCharts. We will include “All Cancer Sites Combined” for comparison purposes.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="lineno"> 1</span> sites <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;Respiratory System&quot;</span><span class="p">,</span>
<span class="lineno"> 2</span>            <span class="s">&quot;Digestive System&quot;</span><span class="p">,</span>
<span class="lineno"> 3</span>            <span class="s">&quot;Prostate&quot;</span><span class="p">,</span>
<span class="lineno"> 4</span>            <span class="s">&quot;Female Breast&quot;</span><span class="p">,</span>
<span class="lineno"> 5</span>            <span class="s">&quot;Male Genital System&quot;</span><span class="p">,</span>
<span class="lineno"> 6</span>            <span class="s">&quot;All Cancer Sites Combined&quot;</span><span class="p">)</span>
<span class="lineno"> 7</span> 
<span class="lineno"> 8</span> c1 <span class="o">&lt;-</span> site_data <span class="o">%&gt;%</span>
<span class="lineno"> 9</span>  filter<span class="p">(</span>site       <span class="o">%in%</span> sites
<span class="lineno">10</span>         year       <span class="o">!=</span> <span class="s">&quot;2007-2011&quot;</span><span class="p">,</span>
<span class="lineno">11</span>         sex        <span class="o">==</span> <span class="s">&quot;Male and Female&quot;</span><span class="p">,</span>
<span class="lineno">12</span>         race       <span class="o">==</span> <span class="s">&quot;All Races&quot;</span><span class="p">,</span>
<span class="lineno">13</span>         event_type <span class="o">==</span> <span class="s">&quot;Incidence&quot;</span><span class="p">,</span>
<span class="lineno">14</span>         count      <span class="o">!=</span> <span class="s">&quot;~&quot;</span><span class="p">,</span>
<span class="lineno">15</span>         count      <span class="o">!=</span> <span class="s">&quot;-&quot;</span><span class="p">,</span>
<span class="lineno">16</span>         count      <span class="o">!=</span> <span class="s">&quot;.&quot;</span><span class="p">,)</span> <span class="o">%&gt;%</span>
<span class="lineno">17</span>  mutate<span class="p">(</span>rate <span class="o">=</span> <span class="p">(</span><span class="kp">as.integer</span><span class="p">(</span>count<span class="p">)</span> <span class="o">/</span> <span class="kp">as.integer</span><span class="p">(</span>population<span class="p">))</span> <span class="o">*</span> <span class="m">1e5</span><span class="p">)</span> <span class="o">%&gt;%</span>
<span class="lineno">18</span>  select<span class="p">(</span>year<span class="p">,</span>
<span class="lineno">19</span>         site<span class="p">,</span>
<span class="lineno">20</span>         rate<span class="p">)</span>
<span class="lineno">21</span> 
<span class="lineno">22</span> c1<span class="o">$</span>rate <span class="o">&lt;-</span> <span class="kp">round</span><span class="p">(</span>c1<span class="o">$</span>rate<span class="p">,</span>
<span class="lineno">23</span>                  digits <span class="o">=</span> <span class="m">2</span><span class="p">)</span></code></pre></div>

<p>Now that our data is in the format we wanted, we can move on to creating the graph. We will first use rChart’s <code>nPlot</code> function to generate an NVD3 object. We will then call specific functions from this object to customize things on our graph.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="lineno"> 1</span> <span class="c1"># Creating the NVD3 object.</span>
<span class="lineno"> 2</span> n1 <span class="o">&lt;-</span> nPlot<span class="p">(</span>norm_count <span class="o">~</span> year<span class="p">,</span>
<span class="lineno"> 3</span>             data  <span class="o">=</span> c1<span class="p">,</span>
<span class="lineno"> 4</span>             group <span class="o">=</span> <span class="s">&quot;site&quot;</span><span class="p">,</span>
<span class="lineno"> 5</span>             type  <span class="o">=</span> <span class="s">&quot;lineChart&quot;</span><span class="p">)</span>
<span class="lineno"> 6</span> 
<span class="lineno"> 7</span> <span class="c1"># Cleaning up the axes.</span>
<span class="lineno"> 8</span> n1<span class="o">$</span>yAxis<span class="p">(</span>showMaxMin <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
<span class="lineno"> 9</span>          axisLabel  <span class="o">=</span> <span class="s">&quot;Rate (per 100,000)&quot;</span><span class="p">,</span>
<span class="lineno">10</span>          width      <span class="o">=</span> <span class="m">47</span><span class="p">)</span>
<span class="lineno">11</span> n1<span class="o">$</span>xAxis<span class="p">(</span>axisLabel <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">)</span>
<span class="lineno">12</span> 
<span class="lineno">13</span> <span class="c1"># Setting up which features are selected by default.</span>
<span class="lineno">14</span> disable_these <span class="o">&lt;-</span> <span class="kp">unique</span><span class="p">(</span>c1<span class="o">$</span>site<span class="p">)</span> <span class="o">==</span> <span class="s">&quot;All Cancer Sites Combined&quot;</span>
<span class="lineno">15</span> n1<span class="o">$</span>set<span class="p">(</span>disabled <span class="o">=</span> disable_these<span class="p">)</span>
<span class="lineno">16</span> 
<span class="lineno">17</span> <span class="c1"># Changing the color of the lines.</span>
<span class="lineno">18</span> n1<span class="o">$</span>chart<span class="p">(</span>color <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;black&quot;</span><span class="p">,</span>
<span class="lineno">19</span>                    brewer.pal<span class="p">(</span><span class="m">5</span><span class="p">,</span> <span class="s">&quot;Dark2&quot;</span><span class="p">)))</span>
<span class="lineno">20</span> 
<span class="lineno">21</span> <span class="c1"># Customizing the tooltip when you hover over an observation.</span>
<span class="lineno">22</span> n1<span class="o">$</span>chart<span class="p">(</span>tooltipContent <span class="o">=</span> <span class="s">&quot;#! function(key, x, y){</span>
<span class="lineno">23</span> <span class="s">         return &#39;&lt;h3&gt;&#39; + key + &#39;&lt;/h3&gt;&#39; +</span>
<span class="lineno">24</span> <span class="s">         &#39;&lt;p&gt;&#39; + y + &#39; per 100,000 diagnosed in &#39; + x + &#39;&lt;/p&gt;&#39;</span>
<span class="lineno">25</span> <span class="s">         } !#&quot;</span><span class="p">)</span></code></pre></div>

<p>If you are using <a href="https://www.rstudio.com/">RStudio</a>, you can just type <code>n1</code> to view and interact with the graph. Or, you can save the graph as an html file, which allows you to view and interact with it in a browser. Saving it as an html file also makes it easy to put it on a website.</p>

<p>You can also easily embed the graph into an <a href="http://rmarkdown.rstudio.com/">R Markdown</a> document, or publish it for free on <a href="http://rpubs.com/">RPubs</a> or <a href="https://gist.github.com/">Gist</a>.</p>

<p>Information on how to do these things is available on the <a href="http://rcharts.readthedocs.org/en/latest/intro/share.html">documentation for rCharts</a>.</p>

<p>Creating a graph comparing genders is very similar to what we did above. We first use dplyr to process the data into the format we need.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="lineno"> 1</span> c2 <span class="o">&lt;-</span> site_data <span class="o">%&gt;%</span>
<span class="lineno"> 2</span>   filter<span class="p">(</span>site       <span class="o">==</span> <span class="s">&quot;All Cancer Sites Combined&quot;</span><span class="p">,</span>
<span class="lineno"> 3</span>          year       <span class="o">!=</span> <span class="s">&quot;2007-2011&quot;</span><span class="p">,</span>
<span class="lineno"> 4</span>          race       <span class="o">==</span> <span class="s">&quot;All Races&quot;</span><span class="p">,</span>
<span class="lineno"> 5</span>          event_type <span class="o">==</span> <span class="s">&quot;Incidence&quot;</span><span class="p">,</span>
<span class="lineno"> 6</span>          count      <span class="o">!=</span> <span class="s">&quot;~&quot;</span><span class="p">,</span>
<span class="lineno"> 7</span>          count      <span class="o">!=</span> <span class="s">&quot;-&quot;</span><span class="p">,</span>
<span class="lineno"> 8</span>          count      <span class="o">!=</span> <span class="s">&quot;.&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
<span class="lineno"> 9</span>   mutate<span class="p">(</span>rate <span class="o">=</span> <span class="p">(</span><span class="kp">as.integer</span><span class="p">(</span>count<span class="p">)</span> <span class="o">/</span> <span class="kp">as.integer</span><span class="p">(</span>population<span class="p">))</span> <span class="o">*</span> <span class="m">1e5</span><span class="p">)</span> <span class="o">%&gt;%</span>
<span class="lineno">10</span>   select<span class="p">(</span>year<span class="p">,</span>
<span class="lineno">11</span>          sex<span class="p">,</span>
<span class="lineno">12</span>          rate<span class="p">)</span>
<span class="lineno">13</span> 
<span class="lineno">14</span> c2<span class="o">$</span>rate <span class="o">&lt;-</span> <span class="kp">round</span><span class="p">(</span>c2<span class="o">$</span>rate<span class="p">,</span>
<span class="lineno">15</span>                  digits <span class="o">=</span> <span class="m">2</span><span class="p">)</span></code></pre></div>

<p>Now we use rCharts to create and customize our graph.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="lineno"> 1</span> <span class="c1"># Creating the NVD3 object.</span>
<span class="lineno"> 2</span> n2 <span class="o">&lt;-</span> nPlot<span class="p">(</span>norm_count <span class="o">~</span> year<span class="p">,</span>
<span class="lineno"> 3</span>             data  <span class="o">=</span> c2<span class="p">,</span>
<span class="lineno"> 4</span>             group <span class="o">=</span> <span class="s">&quot;sex&quot;</span><span class="p">,</span>
<span class="lineno"> 5</span>             type  <span class="o">=</span> <span class="s">&quot;lineChart&quot;</span><span class="p">)</span>
<span class="lineno"> 6</span> 
<span class="lineno"> 7</span> <span class="c1"># Cleaning up the axes.</span>
<span class="lineno"> 8</span> n2<span class="o">$</span>yAxis<span class="p">(</span>showMaxMin <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
<span class="lineno"> 9</span>          axisLabel  <span class="o">=</span> <span class="s">&quot;Rate (per 100,000)&quot;</span><span class="p">,</span>
<span class="lineno">10</span>          width      <span class="o">=</span> <span class="m">47</span><span class="p">)</span>
<span class="lineno">11</span> n2<span class="o">$</span>xAxis<span class="p">(</span>axisLabel <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">)</span>
<span class="lineno">12</span> 
<span class="lineno">13</span> <span class="c1"># Setting up which features are selected by default.</span>
<span class="lineno">14</span> disable_these <span class="o">&lt;-</span> <span class="kp">unique</span><span class="p">(</span>c2<span class="o">$</span>sex<span class="p">)</span> <span class="o">==</span> <span class="s">&quot;Male and Female&quot;</span>
<span class="lineno">15</span> n2<span class="o">$</span>set<span class="p">(</span>disabled <span class="o">=</span> disable_these<span class="p">)</span>
<span class="lineno">16</span> 
<span class="lineno">17</span> <span class="c1"># Changing the color of the lines.</span>
<span class="lineno">18</span> n2<span class="o">$</span>chart<span class="p">(</span>color <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;hotpink&quot;</span><span class="p">,</span>
<span class="lineno">19</span>                    <span class="s">&quot;blue&quot;</span><span class="p">,</span>
<span class="lineno">20</span>                    <span class="s">&quot;black&quot;</span><span class="p">))</span>
<span class="lineno">21</span> 
<span class="lineno">22</span> <span class="c1"># Customizing the tooltip when you hover over an observation.</span>
<span class="lineno">23</span> n2<span class="o">$</span>chart<span class="p">(</span>tooltipContent <span class="o">=</span> <span class="s">&quot;#! function(key, x, y){</span>
<span class="lineno">24</span> <span class="s">        return &#39;&lt;h3&gt;&#39; + key + &#39;&lt;/h3&gt;&#39; +</span>
<span class="lineno">25</span> <span class="s">              &#39;&lt;p&gt;&#39; + y + &#39; per 100,000 diagnosed in &#39; + x + &#39;&lt;/p&gt;&#39;</span>
<span class="lineno">26</span> <span class="s">              } !#&quot;</span><span class="p">)</span></code></pre></div>

<p>Creating a graph to compare races is almost exactly the same as the above code. Just replace “sex” with “race”. Creating a graph that compares age, though, is a bit more tricky. There are some issues with the way R sorts the age column. We have to force factor levels on the age variable to make sure everything is sorted correctly. This is kind of tedious, but it works.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="lineno">1</span> age_data<span class="o">$</span>age <span class="o">&lt;-</span> <span class="kp">factor</span><span class="p">(</span>age_data<span class="o">$</span>age<span class="p">,</span>
<span class="lineno">2</span>                        levels <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;&lt;1&quot;</span><span class="p">,</span> <span class="s">&quot;1-4&quot;</span><span class="p">,</span> <span class="s">&quot;5-9&quot;</span><span class="p">,</span> <span class="s">&quot;10-14&quot;</span><span class="p">,</span> <span class="s">&quot;15-19&quot;</span><span class="p">,</span> <span class="s">&quot;20-24&quot;</span><span class="p">,</span>
<span class="lineno">3</span>                                   <span class="s">&quot;25-29&quot;</span><span class="p">,</span> <span class="s">&quot;30-34&quot;</span><span class="p">,</span> <span class="s">&quot;35-39&quot;</span><span class="p">,</span> <span class="s">&quot;40-44&quot;</span><span class="p">,</span> <span class="s">&quot;45-49&quot;</span><span class="p">,</span>
<span class="lineno">4</span>                                   <span class="s">&quot;50-54&quot;</span><span class="p">,</span> <span class="s">&quot;55-59&quot;</span><span class="p">,</span> <span class="s">&quot;60-64&quot;</span><span class="p">,</span> <span class="s">&quot;65-69&quot;</span><span class="p">,</span> <span class="s">&quot;70-74&quot;</span><span class="p">,</span>
<span class="lineno">5</span>                                   <span class="s">&quot;75-79&quot;</span><span class="p">,</span> <span class="s">&quot;80-84&quot;</span><span class="p">,</span> <span class="s">&quot;85+&quot;</span><span class="p">),</span>
<span class="lineno">6</span>                        ordered <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span></code></pre></div>

<p>Now we can move on to using dplyr and rCharts, and everything comes out as expected.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="lineno"> 1</span> c4 <span class="o">&lt;-</span> age_data <span class="o">%&gt;%</span>
<span class="lineno"> 2</span>   filter<span class="p">(</span>site       <span class="o">==</span> <span class="s">&quot;All Cancer Sites Combined&quot;</span><span class="p">,</span>
<span class="lineno"> 3</span>          year       <span class="o">!=</span> <span class="s">&quot;2007-2011&quot;</span><span class="p">,</span>
<span class="lineno"> 4</span>          sex        <span class="o">==</span> <span class="s">&quot;Male and Female&quot;</span><span class="p">,</span>
<span class="lineno"> 5</span>          race       <span class="o">==</span> <span class="s">&quot;All Races&quot;</span><span class="p">,</span>
<span class="lineno"> 6</span>          event_type <span class="o">==</span> <span class="s">&quot;Incidence&quot;</span><span class="p">,</span>
<span class="lineno"> 7</span>          count      <span class="o">!=</span> <span class="s">&quot;~&quot;</span><span class="p">,</span>
<span class="lineno"> 8</span>          count      <span class="o">!=</span> <span class="s">&quot;-&quot;</span><span class="p">,</span>
<span class="lineno"> 9</span>          count      <span class="o">!=</span> <span class="s">&quot;.&quot;</span><span class="p">,)</span> <span class="o">%&gt;%</span>
<span class="lineno">10</span>   mutate<span class="p">(</span>rate <span class="o">=</span> <span class="p">(</span><span class="kp">as.integer</span><span class="p">(</span>count<span class="p">)</span> <span class="o">/</span> <span class="kp">as.integer</span><span class="p">(</span>population<span class="p">))</span> <span class="o">*</span> <span class="m">1e5</span><span class="p">)</span> <span class="o">%&gt;%</span>
<span class="lineno">11</span>   select<span class="p">(</span>year<span class="p">,</span>
<span class="lineno">12</span>          age<span class="p">,</span>
<span class="lineno">13</span>          rate<span class="p">)</span> <span class="o">%&gt;%</span>
<span class="lineno">14</span>   arrange<span class="p">(</span>year<span class="p">,</span>
<span class="lineno">15</span>           age<span class="p">)</span>
<span class="lineno">16</span> 
<span class="lineno">17</span> c4<span class="o">$</span>rate <span class="o">&lt;-</span> <span class="kp">round</span><span class="p">(</span>c4<span class="o">$</span>rate<span class="p">,</span>
<span class="lineno">18</span>                  digits <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
<span class="lineno">19</span> 
<span class="lineno">20</span> <span class="c1"># Creating the NVD3 object.</span>
<span class="lineno">21</span> n4 <span class="o">&lt;-</span> nPlot<span class="p">(</span>rate <span class="o">~</span> age<span class="p">,</span>
<span class="lineno">22</span>             data  <span class="o">=</span> c4<span class="p">,</span>
<span class="lineno">23</span>             group <span class="o">=</span> <span class="s">&quot;year&quot;</span><span class="p">,</span>
<span class="lineno">24</span>             type  <span class="o">=</span> <span class="s">&quot;multiBarChart&quot;</span><span class="p">)</span>
<span class="lineno">25</span> 
<span class="lineno">26</span> <span class="c1"># Cleaning up the axes.</span>
<span class="lineno">27</span> n4<span class="o">$</span>yAxis<span class="p">(</span>showMaxMin <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
<span class="lineno">28</span>          axisLabel  <span class="o">=</span> <span class="s">&quot;Rate (per 100,000)&quot;</span><span class="p">,</span>
<span class="lineno">29</span>          width      <span class="o">=</span> <span class="m">47</span><span class="p">,</span>
<span class="lineno">30</span>          tickFormat <span class="o">=</span> <span class="s">&quot;#! function(d) {return d} !#&quot;</span><span class="p">)</span>
<span class="lineno">31</span> n4<span class="o">$</span>xAxis<span class="p">(</span>showMaxMin <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
<span class="lineno">32</span>          axisLabel  <span class="o">=</span> <span class="s">&quot;Age&quot;</span><span class="p">)</span>
<span class="lineno">33</span> 
<span class="lineno">34</span> <span class="c1"># Setting up which features are selected by default.</span>
<span class="lineno">35</span> keep_these <span class="o">&lt;-</span> <span class="kp">unique</span><span class="p">(</span>c4<span class="o">$</span>year<span class="p">)</span> <span class="o">==</span> <span class="s">&quot;2011&quot;</span>
<span class="lineno">36</span> n4<span class="o">$</span>set<span class="p">(</span>disabled <span class="o">=</span> <span class="o">!</span>keep_these<span class="p">)</span>
<span class="lineno">37</span> 
<span class="lineno">38</span> <span class="c1"># Changing the color of the lines.</span>
<span class="lineno">39</span> n4<span class="o">$</span>chart<span class="p">(</span>color <span class="o">=</span> colorRampPalette<span class="p">(</span>brewer.pal<span class="p">(</span><span class="m">8</span><span class="p">,</span> <span class="s">&quot;Dark2&quot;</span><span class="p">))(</span><span class="m">13</span><span class="p">))</span>
<span class="lineno">40</span> 
<span class="lineno">41</span> <span class="c1"># Customizing the tooltip when you hover over an observation.</span>
<span class="lineno">42</span> n4<span class="o">$</span>chart<span class="p">(</span>tooltipContent <span class="o">=</span> <span class="s">&quot;#! function(key, x, y){</span>
<span class="lineno">43</span> <span class="s">        return &#39;&lt;h3&gt;&#39; + x + &#39;&lt;/h3&gt;&#39; +</span>
<span class="lineno">44</span> <span class="s">         &#39;&lt;p&gt;&#39; + y + &#39; per 100,000 diagnosed in &#39; + key + &#39;&lt;/p&gt;&#39;</span>
<span class="lineno">45</span> <span class="s">         } !#&quot;</span><span class="p">)</span></code></pre></div>

<p>I would like to end this post by thanking <a href="http://ramnathv.github.io/">Ramnath Vaidyanathan</a> for all the work he has put into rCharts.</p>

</article>

<div class="share-links">

  Share this post:
  <a class="fa fa-twitter" href="https://twitter.com/intent/tweet?text=Using R, rCharts, and NVD3 to Visualize Cancer Rates in the US&url=http://observabledata.com/cancer-how-to/" rel="nofollow" target="_blank" title="Share on Twitter"></a>
  <a class="fa fa-facebook" href="https://facebook.com/sharer.php?u=http://observabledata.com/cancer-how-to/" rel="nofollow" target="_blank" title="Share on Facebook"></a>
  <a class="fa fa-reddit" href="http://reddit.com/submit?url=http://observabledata.com/cancer-how-to/&title=Using R, rCharts, and NVD3 to Visualize Cancer Rates in the US" rel="nofollow" target="_blank" title="Share on Reddit"></a>
  <a class = "fa fa-hacker-news" onclick="parent.postMessage('submit','*')" href="https://news.ycombinator.com/submitlink?u=http://observabledata.com/cancer-how-to/&t=Using R, rCharts, and NVD3 to Visualize Cancer Rates in the US" rel="nofollow" target="_blank" title="Share on Hacker News"></a>
</div>


Like this post:
<div
  class="fb-like"
  data-href=""
  data-layout="button"
  data-height: "16px"
  data-action="like"
  data-show-faces="true">
</div>



  


<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname  = 'observabledata';
  var disqus_identifier = '/cancer_how-to';
  var disqus_title      = '';

  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>




      </div>
    </div>
  </div>

  <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'observabledata';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
  </script>

</body>
</html>
